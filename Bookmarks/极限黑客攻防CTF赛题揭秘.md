### 第1章 Web类赛题

#### 1.SQL注入漏洞

##### 关键词绕过

- 编码绕过：URL编码、ASCII编码

- 字母大小写绕过

- 在关键词内添加无效字符：SE%00LECT、Sel%0bECT

- 内联注释绕过：/*! code */

- 利用被删除的关键词绕过：双写绕过等

- 等价函数与命令绕过

  - ```php
    && => and    || => or
    ```

  - ```php
    %20 %09 %0a %0b %0c %0d %a0 /**/ 制表符 ()	反引号 => 空格
    ```

  - ```php
    and 1 like 1 => and 1=1    and 2>1 => and 1=1				and 2<1 => and 1=2
    ```

  - ```php
    sleep() => benchmark()    concat_ws => group_concat    @@user => user()
    ```

- 宽字节绕过、溢出绕过等

##### 截断绕过

URL中的%00在ASCII码中表示0，而ASCII码中的0表示字符串的结束。所以当URL中出现%00时服务器会认为URL已经结束，不会再去检测后面的内容，而这将引发绕过验证。当一些参数被WAF检测到时，如SELECT被过滤，先尝试关键词绕过的方法无果后可以考虑使用添加无效字符的方法绕过"SEL%00ECT"。如果手工注入不方便，可以使用sqlmap中的template脚本，其中的InsertNullCharInSQLKeywords.py可以指定需要添加空字符的关键词。

##### 二次注入

To Do：一些案例

#### 2.XSS漏洞

##### 留言板

通过https://requestb.in/新建一个RequestBin，将生成的地址插入到留言中，可以获得管理员的Cookie等信息。

##### 评论区

可以通过在评论区输入

```php
test<scrip>alert("whoops");</scrip>
```

来测试是否有XSS漏洞，之后可以通过构造特殊的命令获取到Cookie等信息。

##### JavaScript限制

有些题目会有javascript函数对我们的输入进行替换或过滤等，此时将js脚本的内容进行修改即可。

#### 3.命令执行漏洞

注意观察隐藏在网站功能里的命令注入点，如file、ping、curl等，通过通配符、|、&进行命令拼接。

#### 4.文件上传漏洞

在正常情况下，服务器会对上传文件的格式或内容进行校验，几乎不可能允许直接上传文件。攻击者需要对不同的防御方式进行绕过，才能上传文件。常见的上传绕过方法有：

- 客户端绕过：抓包、改包
- 服务端绕过：文件类型、文件头、文件后缀
- 配合文件包含、服务器解析漏洞或操作系统文件命名规则绕过
- CMS、编辑器漏洞绕过
- WAF绕过

##### MIME

MIME，是多用途互联网邮件扩展类型的缩写，修改MIME是一种绕过验证的方法。在解题时我们首先要知道题目的上传功能都进行了哪些验证，上传验证大致分为前端和后端验证。前端验证方法只有一种，就是javascript验证，即通过前端javascript语言对上传的文件进行验证，从而判断文件是否合法。后端验证的方法要比前端验证的方法多一些，常见的有MIME验证、文件目录验证、文件扩展名验证、文件内容验证等。判断所采用的验证方法，可以使用Burp抓包工具抓取上传的数据包并进行修改。对于前端验证，只要查看提交请求时是否可以抓到请求包即可。如果Burp没有抓到请求包，而浏览器已经返回了结果，就说明上传验证是在前端进行过滤的，请求没有发到服务端；如果抓到了请求包，就说明过滤是在服务端进行的。

##### PHP标签

对于一些上传题，可能并不会对文件类型和文件后缀进行检测，而是对其中的内容关键词进行过滤。如删除了php头的<?或eval等，有以下方法对此进行绕过

```php
<?php ?>	//标准标签
<script language="php"></script>	//js格式的标签，常用于绕过上传验证机制
<? ?>	//PHP短标签，需要在配置文件里修改short_open_tag选项
<% %>	//PHP短标签，需要在配置文件里修改short_open_tag选项
```

对于eval的过滤，可以考虑其他命令执行的函数，也可以将命令执行的值显示出来即可，如

```php
<script language="php">echo '$_POST[shell]';</script>
```

对shell传入命令参数即可打印命令执行的结果。

### 第2-4章

To Do：二进制相关知识阅读笔记

### 第5章 Misc类赛题

#### 1.密码学基础

##### 摩斯密码

题目中遇到重复出现的两到三个字符（第三个字符是分隔符），考虑可能是摩斯密码，将字符替换成.和-使用摩斯密码表解密。

##### 恺撒密码、栅栏密码、RSA算法

##### NTLM密码

Windows操作系统的Hash密码形如

```
nick:1003:8EA9109FDA91D6BFC6EBE8776A153FEB:C6002D00F57F9F399B6263D714AF8C3A:::
```

其中c600...这一段就是NTLM—HASH值，输入到一些hash破解网站可能可以得到明文密码。

##### 键盘图案密码

一些奇怪的字母组合如4esz4rfvsdf考虑26键键盘的图案，此外如果是数字组合也可能是9键键盘。

#### 2.隐写

对于隐写问题最先考虑用WinHex或010 Editor查看二进制信息，可能会获得一些有效信息。

##### 图片隐写

对于能够打开的图片，可以使用binwalk等工具先查看是不是多文件合成的图片。如果图片没有规则意义，可以考虑数据被藏入到RGB数据中，可以使用PIL中的Image库取出每个像素的RGB数据并转换成十六进制值，将所有值合并写入到文件中修改后缀，使用图片查看工具观察是否能够得到有效信息。

##### 无法正常打开的文件

遇到无法打开的未知文件，可以先查看二进制信息，了解是什么类型的文件。如果也无法识别，考虑文件头的二进制数据缺失，可以根据标识对照进行添加。

|     扩展名     |    文件头标识（HEX）    |       文件描述        |
| :------------: | :---------------------: | :-------------------: |
|       7z       |    37 7A BC AF 27 1C    | 7-ZIP compressed file |
|      asf       |  30 26 B2 75 8E 66 CF   |     Windows Media     |
| zip、jar、zipx |       50 4B 03 04       |      ZIP Archive      |
|      xml       |     3C 3F 78 6D 6C      |     XML Document      |
|      rar       |       52 61 72 21       |   RAR Archive File    |
|      png       | 89 50 4E 47 0D 0A 1A 0A |    PNG Image File     |
|      pdf       |  25 50 44 46 2D 31 2E   |     Adobe Acrobat     |
|   jpg、jpeg    |     FF D8 FF E0 00      |   JPG Graphic File    |
|   jpg、jpeg    |     FF D8 FF FE 00      |   JPG Graphic File    |

##### 压缩包伪加密