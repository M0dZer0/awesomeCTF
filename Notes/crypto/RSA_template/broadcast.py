
from gmpy2 import *
from Crypto.Util.number import long_to_bytes as l2b
from Crypto.Util.number import long_to_bytes, bytes_to_long
 
ns = [96407689072888199414529533654468846753183599250070979733967944610912107577141917148156085001973840801859302584896539963435032267261286403600911267010992464533343773611423282305083628305634982176135071215039790101123388456576533202708278955691736476876207440784528526696789877267227811634036821299289681114657,66401308200345833003887181331630446418784996658916412153617642394355594681147229706612853484198337788559247915291353963808399057411762159070503266790254418789233905453459509338658178123102478684718992509300266053728344066067760392102016420881722889638144406686642332309858301873245474662674532812281598921077,80494028036838123130952328724575467524413737462241579974381983813304289918933917402613688055046167247039113757746859679667217210318938019030143917067855473953308952299018674464505678375677926401791678435165770557118695557679360519913365072972554473849262675068982131023988016376470878600396442957073705115659]
cs = [78071507264092438819629872661492463310180029317564745405064626203691734541394799057270023742575483678110517393610063120897533750105557826631715908737762120148763648420482337459885852601975003566859499044229913390765068088410465914225619826485278365061850984958016438689013641147536619312226021282274650778196,60281350330247961797128515130973960797796345551984694058504361675329104469655822980067513775898203580360191638601525313257743232464291252857415219197566950860405120319364254206003929864573913103428216894129879921749956673868417774773113599124153060103188560109832527408320848785067121900569581233973117764752,39535506491720576898237746103891707079775756851958220779630063952174687583432457536982297525336234921176906245271179571153044972889961089509877437966775435368469427312783590219096387695527645206465121178092268223565960609430069432613579090808994763869148689914148700615407318859201767487617862723800969777273]
e = 3
assert len(ns) == len(cs) == e  # e为x，就需要x组n和c
 
def CRT(N, C):
    nmul = 1
    for i in N:
        nmul *= i
    sum = 0
    for n, c in zip(N, C):
        nresidue = nmul // n
        sum += c * nresidue * invert(nresidue, n)
    x = sum % nmul
    return x
 
x = CRT(ns, cs)
m = int(iroot(x, e)[0])
print(l2b(m))

message = input("Enter text to encrypt: ")
m = bytes_to_long(message.encode())
print(m)